<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>MyWebServer</title>
    <link href="/2024/06/02/MyWebServer/"/>
    <url>/2024/06/02/MyWebServer/</url>
    
    <content type="html"><![CDATA[<h1 id="MyWebServer"><a href="#MyWebServer" class="headerlink" title="MyWebServer"></a>MyWebServer</h1><h2 id="webserver学习总结"><a href="#webserver学习总结" class="headerlink" title="webserver学习总结"></a>webserver学习总结</h2><h3 id="参考内容"><a href="#参考内容" class="headerlink" title="参考内容"></a>参考内容</h3><p>[1、小白视角：一文读懂社长的TinyWebServer(Raw_Version)](<a href="https://huixxi.github.io/2020/06/02/%E5%B0%8F%E7%99%BD%E8%A7%86%E8%A7%92%EF%BC%9A%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%E7%A4%BE%E9%95%BF%E7%9A%84TinyWebServer/#more">小白视角：一文读懂社长的TinyWebServer | HU (huixxi.github.io)</a>)</p><h3 id="Socket网络编程"><a href="#Socket网络编程" class="headerlink" title="Socket网络编程"></a>Socket网络编程</h3><h4 id="压力测试"><a href="#压力测试" class="headerlink" title="压力测试"></a>压力测试</h4><p>使用webbench工具进行测试，直接运行因为权限问题不够找不到命令无法执行，使用下面的命令</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c++">gcc webbench.c -o webbench<br></code></pre></td></tr></table></figure><p>重新编译该文件时遇到报错</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">webbench.c:<span class="hljs-number">21</span>:<span class="hljs-number">10</span>: fatal error: rpc/types.h: 没有那个文件或目录<br>   <span class="hljs-number">21</span> | <span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;rpc/types.h&gt;</span></span><br>      |          ^~~~~~~~~~~~~<br>解决方案：将&lt;rpc/typed.h&gt;改为&lt;sys/typed.h&gt;后重新编译<br></code></pre></td></tr></table></figure><p>然后在解压目录打开终端运行命令（<code>-c</code>表示客户端数， <code>-t</code>表示时间）：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./webbench -c <span class="hljs-number">10001</span> -t <span class="hljs-number">5</span> http:<span class="hljs-comment">//127.0.0.1:9006/</span><br></code></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">Webbench - Simple Web Benchmark <span class="hljs-number">1.5</span><br>Copyright (c) Radim Kolar <span class="hljs-number">1997</span><span class="hljs-number">-2004</span>, GPL Open Source Software.<br><br>Benchmarking: GET http:<span class="hljs-comment">//127.0.0.1:9007/</span><br><span class="hljs-number">10001</span> clients, running <span class="hljs-number">5</span> sec.<br><br>Speed=<span class="hljs-number">503340</span> pages/min, <span class="hljs-number">939568</span> bytes/sec.<br>Requests: <span class="hljs-number">41945</span> susceed, <span class="hljs-number">0</span> failed.<br></code></pre></td></tr></table></figure><h4 id="Webbench是什么，介绍一下原理"><a href="#Webbench是什么，介绍一下原理" class="headerlink" title="Webbench是什么，介绍一下原理"></a>Webbench是什么，介绍一下原理</h4><p>WebBench 是一个简单、实用的 Web 压力测试工具。它主要用于测试 Web 服务器的性能，通过模拟大量客户端访问服务器，以评估服务器在高负载下的表现。</p><p>父进程fork若干个子进程，每个子进程在用户要求时间或默认的时间内对目标web循环发出实际访问请求，父子进程通过管道进行通信，子进程通过管道写端向父进程传递在若干次请求访问完毕后记录到的总信息，父进程通过管道读端读取子进程发来的相关信息，子进程在时间到后结束，父进程在所有子进程退出后统计并给用户显示最后的测试结果，然后退出。</p><h2 id="添加功能"><a href="#添加功能" class="headerlink" title="添加功能"></a>添加功能</h2><h3 id="添加一个HTML和CSS的登录界面"><a href="#添加一个HTML和CSS的登录界面" class="headerlink" title="添加一个HTML和CSS的登录界面"></a>添加一个HTML和CSS的登录界面</h3><p>HTML和CSS素材来自：<a href="https://mp.weixin.qq.com/s/0snX38O4LQsglgd_dsY57g">微信公众号</a></p><h4 id="代码中响应HTTP的逻辑部分"><a href="#代码中响应HTTP的逻辑部分" class="headerlink" title="代码中响应HTTP的逻辑部分"></a>代码中响应HTTP的逻辑部分</h4><p>该方法中可以根据HTML代码中的 <code>form</code> 中的 <code>action</code> 和 <code>post</code> 方法，来传输到服务器中进行逻辑判断</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>新用户<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure><p>服务器代码中实现处理HTTP请求的方法在文件 <code>http_conn.cpp</code> 中</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// 处理HTTP请求的方法</span><br><span class="hljs-function">http_conn::HTTP_CODE <span class="hljs-title">http_conn::do_request</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">strcpy</span>(m_real_file, doc_root);      <span class="hljs-comment">// 将 doc_root 的值复制到 m_real_file 中</span><br>    <span class="hljs-type">int</span> len = <span class="hljs-built_in">strlen</span>(doc_root);<br>    <span class="hljs-comment">//printf(&quot;m_url:%s\n&quot;, m_url);</span><br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *p = <span class="hljs-built_in">strrchr</span>(m_url, <span class="hljs-string">&#x27;/&#x27;</span>);    <span class="hljs-comment">// 查找m_url中最后一个/字符的位置。</span><br><br>    <span class="hljs-comment">//处理cgi       如果cgi标志为1，并且URL中最后一个/后面紧跟的字符是&#x27;2&#x27;或&#x27;3&#x27;，进入处理CGI部分的代码块。</span><br>    <span class="hljs-keyword">if</span> (cgi == <span class="hljs-number">1</span> &amp;&amp; (*(p + <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;2&#x27;</span> || *(p + <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;3&#x27;</span>))   <br>    &#123;<br>        <span class="hljs-comment">//根据标志判断是登录检测还是注册检测</span><br>        <span class="hljs-type">char</span> flag = m_url[<span class="hljs-number">1</span>];  <span class="hljs-comment">// 获取m_url中的第二个字符，存储在flag中。</span><br><br>        <span class="hljs-comment">// 动态分配200字节的内存给m_url_real，并将m_url从第三个字符开始的子串连接到/后面，</span><br>        <span class="hljs-comment">// 构建新的URL路径，最后将其复制到m_real_file中，并释放分配的内存。</span><br>        <span class="hljs-type">char</span> *m_url_real = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>) * <span class="hljs-number">200</span>);<br>        <span class="hljs-built_in">strcpy</span>(m_url_real, <span class="hljs-string">&quot;/&quot;</span>);<br>        <span class="hljs-built_in">strcat</span>(m_url_real, m_url + <span class="hljs-number">2</span>);<br>        <span class="hljs-built_in">strncpy</span>(m_real_file + len, m_url_real, FILENAME_LEN - len - <span class="hljs-number">1</span>);<br>        <span class="hljs-built_in">free</span>(m_url_real);<br><br>        <span class="hljs-comment">//将用户名和密码提取出来</span><br>        <span class="hljs-comment">//user=123&amp;passwd=123</span><br>        <span class="hljs-type">char</span> name[<span class="hljs-number">100</span>], password[<span class="hljs-number">100</span>];<br>        <span class="hljs-type">int</span> i;<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">5</span>; m_string[i] != <span class="hljs-string">&#x27;&amp;&#x27;</span>; ++i)<br>            name[i - <span class="hljs-number">5</span>] = m_string[i];<br>        name[i - <span class="hljs-number">5</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br><br>        <span class="hljs-type">int</span> j = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (i = i + <span class="hljs-number">10</span>; m_string[i] != <span class="hljs-string">&#x27;\0&#x27;</span>; ++i, ++j)<br>            password[j] = m_string[i];<br>        password[j] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br><br>        <span class="hljs-comment">//如果是注册，先检测数据库中是否有重名的</span><br>        <span class="hljs-comment">//没有重名的，进行增加数据</span><br>        <span class="hljs-keyword">if</span> (*(p + <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;3&#x27;</span>)<br>        &#123;<br>            <span class="hljs-type">char</span> *sql_insert = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>) * <span class="hljs-number">200</span>);<br>            <span class="hljs-built_in">strcpy</span>(sql_insert, <span class="hljs-string">&quot;INSERT INTO user(username, passwd) VALUES(&quot;</span>);<br>            <span class="hljs-built_in">strcat</span>(sql_insert, <span class="hljs-string">&quot;&#x27;&quot;</span>);<br>            <span class="hljs-built_in">strcat</span>(sql_insert, name);<br>            <span class="hljs-built_in">strcat</span>(sql_insert, <span class="hljs-string">&quot;&#x27;, &#x27;&quot;</span>);<br>            <span class="hljs-built_in">strcat</span>(sql_insert, password);<br>            <span class="hljs-built_in">strcat</span>(sql_insert, <span class="hljs-string">&quot;&#x27;)&quot;</span>);<br><br>            <span class="hljs-keyword">if</span> (users.<span class="hljs-built_in">find</span>(name) == users.<span class="hljs-built_in">end</span>())<br>            &#123;<br>                m_lock.<span class="hljs-built_in">lock</span>();<br>                <span class="hljs-type">int</span> res = <span class="hljs-built_in">mysql_query</span>(mysql, sql_insert);<br>                users.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">pair</span>&lt;string, string&gt;(name, password));<br>                m_lock.<span class="hljs-built_in">unlock</span>();<br><br>                <span class="hljs-keyword">if</span> (!res)<br>                    <span class="hljs-built_in">strcpy</span>(m_url, <span class="hljs-string">&quot;/log.html&quot;</span>);<br>                <span class="hljs-keyword">else</span><br>                    <span class="hljs-built_in">strcpy</span>(m_url, <span class="hljs-string">&quot;/registerError.html&quot;</span>);<br>            &#125;<br>            <span class="hljs-keyword">else</span><br>                <span class="hljs-built_in">strcpy</span>(m_url, <span class="hljs-string">&quot;/registerError.html&quot;</span>);<br>        &#125;<br>        <span class="hljs-comment">//如果是登录，直接判断</span><br>        <span class="hljs-comment">//若浏览器端输入的用户名和密码在表中可以查找到，返回1，否则返回0</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*(p + <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;2&#x27;</span>)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (users.<span class="hljs-built_in">find</span>(name) != users.<span class="hljs-built_in">end</span>() &amp;&amp; users[name] == password)<br>                <span class="hljs-built_in">strcpy</span>(m_url, <span class="hljs-string">&quot;/welcome.html&quot;</span>);<br>            <span class="hljs-keyword">else</span><br>                <span class="hljs-built_in">strcpy</span>(m_url, <span class="hljs-string">&quot;/logError.html&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (*(p + <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;0&#x27;</span>)    <span class="hljs-comment">// 如果`URL`中最后一个`/`后面的字符是&#x27;0&#x27;，处理注册页面请求：</span><br>    &#123;   <br>        <span class="hljs-comment">// 构建注册页面路径并复制到m_real_file中，然后释放动态分配的内存。</span><br>        <span class="hljs-type">char</span> *m_url_real = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>) * <span class="hljs-number">200</span>);<br>        <span class="hljs-built_in">strcpy</span>(m_url_real, <span class="hljs-string">&quot;/register.html&quot;</span>);<br>        <span class="hljs-built_in">strncpy</span>(m_real_file + len, m_url_real, <span class="hljs-built_in">strlen</span>(m_url_real));<br><br>        <span class="hljs-built_in">free</span>(m_url_real);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*(p + <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;1&#x27;</span>)   <span class="hljs-comment">// 如果`URL`中最后一个`/`后面的字符是&#x27;1&#x27;，处理登录页面请求：</span><br>    &#123;<br>        <span class="hljs-type">char</span> *m_url_real = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>) * <span class="hljs-number">200</span>);<br>        <span class="hljs-built_in">strcpy</span>(m_url_real, <span class="hljs-string">&quot;/log.html&quot;</span>);<br>        <span class="hljs-built_in">strncpy</span>(m_real_file + len, m_url_real, <span class="hljs-built_in">strlen</span>(m_url_real));<br><br>        <span class="hljs-built_in">free</span>(m_url_real);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*(p + <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;5&#x27;</span>) <span class="hljs-comment">// 如果`URL`中最后一个`/`后面的字符是&#x27;5&#x27;，处理图片页面请求：</span><br>    &#123;<br>        <span class="hljs-type">char</span> *m_url_real = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>) * <span class="hljs-number">200</span>);<br>        <span class="hljs-built_in">strcpy</span>(m_url_real, <span class="hljs-string">&quot;/picture.html&quot;</span>);<br>        <span class="hljs-built_in">strncpy</span>(m_real_file + len, m_url_real, <span class="hljs-built_in">strlen</span>(m_url_real));<br><br>        <span class="hljs-built_in">free</span>(m_url_real);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*(p + <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;6&#x27;</span>)  <span class="hljs-comment">// 如果`URL`中最后一个`/`后面的字符是&#x27;6&#x27;，处理视频页面请求：</span><br>    &#123;<br>        <span class="hljs-type">char</span> *m_url_real = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>) * <span class="hljs-number">200</span>);<br>        <span class="hljs-built_in">strcpy</span>(m_url_real, <span class="hljs-string">&quot;/video.html&quot;</span>);<br>        <span class="hljs-built_in">strncpy</span>(m_real_file + len, m_url_real, <span class="hljs-built_in">strlen</span>(m_url_real));<br><br>        <span class="hljs-built_in">free</span>(m_url_real);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*(p + <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;7&#x27;</span>)   <span class="hljs-comment">// 如果`URL`中最后一个`/`后面的字符是&#x27;7&#x27;，处理粉丝页面请求：</span><br>    &#123;<br>        <span class="hljs-type">char</span> *m_url_real = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>) * <span class="hljs-number">200</span>);<br>        <span class="hljs-built_in">strcpy</span>(m_url_real, <span class="hljs-string">&quot;/fans.html&quot;</span>);<br>        <span class="hljs-built_in">strncpy</span>(m_real_file + len, m_url_real, <span class="hljs-built_in">strlen</span>(m_url_real));<br><br>        <span class="hljs-built_in">free</span>(m_url_real);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">strncpy</span>(m_real_file + len, m_url, FILENAME_LEN - len - <span class="hljs-number">1</span>); <span class="hljs-comment">// 处理其他未明确指定的请求，直接将`m_url`复制到`m_real_file`中。</span><br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">stat</span>(m_real_file, &amp;m_file_stat) &lt; <span class="hljs-number">0</span>)    <span class="hljs-comment">// 检查m_real_file是否存在。如果不存在，返回NO_RESOURCE错误</span><br>        <span class="hljs-keyword">return</span> NO_RESOURCE;<br><br>    <span class="hljs-keyword">if</span> (!(m_file_stat.st_mode &amp; S_IROTH))   <span class="hljs-comment">// 检查文件权限。如果文件不可读，返回`FORBIDDEN_REQUEST`错误。</span><br>        <span class="hljs-keyword">return</span> FORBIDDEN_REQUEST;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">S_ISDIR</span>(m_file_stat.st_mode))   <span class="hljs-comment">// 检查文件类型。如果是目录，返回BAD_REQUEST错误。</span><br>        <span class="hljs-keyword">return</span> BAD_REQUEST;<br><br>    <span class="hljs-comment">// 打开文件并将其映射到内存中，然后关闭文件描述符，返回`FILE_REQUEST`。</span><br>    <span class="hljs-type">int</span> fd = <span class="hljs-built_in">open</span>(m_real_file, O_RDONLY);<br>    m_file_address = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">mmap</span>(<span class="hljs-number">0</span>, m_file_stat.st_size, PROT_READ, MAP_PRIVATE, fd, <span class="hljs-number">0</span>);<br>    <span class="hljs-built_in">close</span>(fd);<br>    <span class="hljs-keyword">return</span> FILE_REQUEST;<br>&#125;<br></code></pre></td></tr></table></figure><p>用GPT生成了 <code>root</code> 目录下的 <code>style.css</code> 文件，修改了 <code>judge.html</code> 、<code>log.html</code> 、<code>register.html</code> 文件，使其符合要求</p><p>其中，有一部分不太明白，我觉得应该去看看HTML请求体的结构和内容</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;2CGISQL.cgi&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span>用户名:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;用户名&quot;</span> <span class="hljs-attr">required</span>=<span class="hljs-string">&quot;required&quot;</span>&gt;</span><span class="hljs-comment">&lt;!-- 这部分不太懂 --&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span>密码:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;登录密码&quot;</span> <span class="hljs-attr">required</span>=<span class="hljs-string">&quot;required&quot;</span>&gt;</span>  <span class="hljs-comment">&lt;!-- 这部分不太懂 --&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;button&quot;</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>项目</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>page_1</title>
    <link href="/2024/06/01/page_1/"/>
    <url>/2024/06/01/page_1/</url>
    
    <content type="html"><![CDATA[<h1 id="如何使用Vscode和github完成代码版本控制"><a href="#如何使用Vscode和github完成代码版本控制" class="headerlink" title="如何使用Vscode和github完成代码版本控制"></a>如何使用Vscode和github完成代码版本控制</h1><h2 id="Git使用"><a href="#Git使用" class="headerlink" title="Git使用"></a>Git使用</h2><p>参考内容：<a href="https://www.liaoxuefeng.com/wiki/896043488029600/896827951938304">廖雪峰git教程</a></p><h3 id="1、创建本地版本库"><a href="#1、创建本地版本库" class="headerlink" title="1、创建本地版本库"></a>1、创建本地版本库</h3><h4 id="1）选择合适的地方，创建一个空目录，并进入目录"><a href="#1）选择合适的地方，创建一个空目录，并进入目录" class="headerlink" title="1）选择合适的地方，创建一个空目录，并进入目录"></a>1）选择合适的地方，创建一个空目录，并进入目录</h4><p>win系统下最好不包括中文目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">mkdir</span> MyWebServer</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> MyWebServer</span><br></code></pre></td></tr></table></figure><h4 id="2）将目录变成git可以管理的仓库"><a href="#2）将目录变成git可以管理的仓库" class="headerlink" title="2）将目录变成git可以管理的仓库"></a>2）将目录变成git可以管理的仓库</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs swift">$ git <span class="hljs-keyword">init</span><br><span class="hljs-type">Initialized</span> empty <span class="hljs-type">Git</span> repository <span class="hljs-keyword">in</span> <span class="hljs-type">E</span>:<span class="hljs-regexp">/MyGit/</span><span class="hljs-type">MyWebServer</span><span class="hljs-regexp">/.git/</span><br><br>ls <span class="hljs-operator">-</span>ah<span class="hljs-comment">// Linux下可以看见隐藏的文件</span><br></code></pre></td></tr></table></figure><p>此时会生成一个 <strong>.git</strong> 文件，是 Git 用来跟踪管理版本的</p><h4 id="3）把文件添加到版本库"><a href="#3）把文件添加到版本库" class="headerlink" title="3）把文件添加到版本库"></a>3）把文件添加到版本库</h4><p>在<strong>新建的目录下</strong>，新建一个 <strong>readme.md</strong> 文件，文件内写上（不要用win自带的文本编辑器打开编写）：</p><figure class="highlight mercury"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mercury">Git <span class="hljs-keyword">is</span> a version control system.<br>Git <span class="hljs-keyword">is</span> free software.<br></code></pre></td></tr></table></figure><p>使用 <strong>Git</strong> 命令 把文件添加到仓库：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-comment">// 第一步，添加文件到仓库</span><br>$ git add readme<span class="hljs-selector-class">.md</span><br><br><span class="hljs-comment">// 第二步，将文件提交到仓库</span><br>$ git commit -m <span class="hljs-string">&quot;添加本次仓库测试的文档&quot;</span><br><br><span class="hljs-selector-attr">[main (root-commit) 8d1a06f]</span> 添加本次仓库测试的文档<br> <span class="hljs-number">1</span> file changed, <span class="hljs-number">0</span> <span class="hljs-built_in">insertions</span>(+), <span class="hljs-number">0</span> <span class="hljs-built_in">deletions</span>(-)<br> create mode <span class="hljs-number">100644</span> readme<span class="hljs-selector-class">.md</span><br><br></code></pre></td></tr></table></figure><p><strong>git commit -m “添加本次仓库测试的文档”</strong> 命令，**-m** 后面输入的是本次提交的说明，可以输入任意内容，当然最好是有意义的，这样你就能从历史记录里方便地找到改动记录。</p><h3 id="2、添加远程库"><a href="#2、添加远程库" class="headerlink" title="2、添加远程库"></a>2、添加远程库</h3><p>现在的情景是，你已经在本地创建了一个Git仓库后，又想在GitHub创建一个Git仓库，并且让这两个仓库进行远程同步，这样，GitHub上的仓库既可以作为备份，又可以让其他人通过该仓库来协作，真是一举多得。</p><h4 id="1）在GitHub上创建一个新的仓库"><a href="#1）在GitHub上创建一个新的仓库" class="headerlink" title="1）在GitHub上创建一个新的仓库"></a>1）在GitHub上创建一个新的仓库</h4><p>图形化操作</p><h4 id="2）绑定远程仓库"><a href="#2）绑定远程仓库" class="headerlink" title="2）绑定远程仓库"></a>2）绑定远程仓库</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-comment">// 使用命令下面命令绑定远程库      git remote add [远端仓库别名] [远端仓库地址]</span><br>$ git remote add MyWebServer_origin git<span class="hljs-keyword">@github</span>.<span class="hljs-attribute">com</span>:zy674517173/MyWebServer_origin.git<br></code></pre></td></tr></table></figure><h4 id="3）把本地库的内容推送到远程库"><a href="#3）把本地库的内容推送到远程库" class="headerlink" title="3）把本地库的内容推送到远程库"></a>3）把本地库的内容推送到远程库</h4><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">// 使用命令下面命令推送      git push -u [远端仓库别名] [推送的位置]</span><br>$ git push -u <span class="hljs-type">MyWebServer_origin</span> main<br><br><span class="hljs-type">Enumerating</span> objects: <span class="hljs-number">5</span>, <span class="hljs-keyword">done</span>.<br><span class="hljs-type">Counting</span> objects: <span class="hljs-number">100</span>% (<span class="hljs-number">5</span>/<span class="hljs-number">5</span>), <span class="hljs-keyword">done</span>.<br><span class="hljs-type">Delta</span> compression using up <span class="hljs-keyword">to</span> <span class="hljs-number">12</span> threads<br><span class="hljs-type">Compressing</span> objects: <span class="hljs-number">100</span>% (<span class="hljs-number">2</span>/<span class="hljs-number">2</span>), <span class="hljs-keyword">done</span>.<br><span class="hljs-type">Writing</span> objects: <span class="hljs-number">100</span>% (<span class="hljs-number">4</span>/<span class="hljs-number">4</span>), <span class="hljs-number">384</span> <span class="hljs-built_in">bytes</span> | <span class="hljs-number">384.00</span> <span class="hljs-type">KiB</span>/s, <span class="hljs-keyword">done</span>.<br><span class="hljs-type">Total</span> <span class="hljs-number">4</span> (delta <span class="hljs-number">1</span>), reused <span class="hljs-number">0</span> (delta <span class="hljs-number">0</span>), pack-reused <span class="hljs-number">0</span> (from <span class="hljs-number">0</span>)<br>remote: <span class="hljs-type">Resolving</span> deltas: <span class="hljs-number">100</span>% (<span class="hljs-number">1</span>/<span class="hljs-number">1</span>), <span class="hljs-keyword">done</span>.<br><span class="hljs-type">To</span> github.com:zy674517173/<span class="hljs-type">MyWebServer_origin</span>.git<br>   af59730..<span class="hljs-number">5</span>aa9a4d  main -&gt; main<br>branch <span class="hljs-symbol">&#x27;main&#x27;</span> set up <span class="hljs-keyword">to</span> track <span class="hljs-symbol">&#x27;MyWebServer_origin</span>/main&#x27;.<br></code></pre></td></tr></table></figure><p><strong>报错</strong></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">error: failed <span class="hljs-built_in">to</span> push some refs <span class="hljs-built_in">to</span> <span class="hljs-string">&#x27;github.com:zy674517173/MyWebServer_origin.git&#x27;</span><br>hint: Updates were rejected because <span class="hljs-keyword">the</span> remote <span class="hljs-keyword">contains</span> work that you <span class="hljs-built_in">do</span> <span class="hljs-keyword">not</span><br>hint: have locally. This is usually caused <span class="hljs-keyword">by</span> another repository pushing <span class="hljs-built_in">to</span><br>hint: <span class="hljs-keyword">the</span> same ref. If you want <span class="hljs-built_in">to</span> integrate <span class="hljs-keyword">the</span> remote changes, use<br>hint: <span class="hljs-string">&#x27;git pull&#x27;</span> <span class="hljs-keyword">before</span> pushing again.<br>hint: See <span class="hljs-keyword">the</span> <span class="hljs-string">&#x27;Note about fast-forwards&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;git push --help&#x27;</span> <span class="hljs-keyword">for</span> details.<br><br>解决方案<br>将仓库里的 README.md 文件删除，然后执行命令<br>$ git pull MyWebServer_origin main <span class="hljs-comment">--allow-unrelated-histories   // 从远端仓库拉取，同步本地</span><br></code></pre></td></tr></table></figure><h4 id="4）后续"><a href="#4）后续" class="headerlink" title="4）后续"></a>4）后续</h4><p>从现在开始，本地做了提交，就可以通过命令</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">git <span class="hljs-built_in">push</span> MyWebServer_origin main<br></code></pre></td></tr></table></figure><p>把本地的 <strong>main</strong> 分支的最新修改推送至 GitHub 。</p><h5 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h5><p>关联一个远程库时必须给远程库指定一个名字，<code>origin</code> 是默认习惯命名；</p><p>关联后，使用命令 <strong>git push -u origin master</strong> 第一次推送master分支的所有内容；</p><p>此后，每次本地提交后，只要有必要，就可以使用命令 <strong>git push origin master</strong> 推送最新修改；</p><h4 id="5）删除远程库"><a href="#5）删除远程库" class="headerlink" title="5）删除远程库"></a>5）删除远程库</h4><h5 id="查看远程库信息"><a href="#查看远程库信息" class="headerlink" title="查看远程库信息"></a>查看远程库信息</h5><p>如果添加的时候地址写错了，或者就是想删除远程库，可以用 <strong>git remote rm [name]</strong> 命令。使用前，建议先用 <strong>git remote -v</strong> 查看远程库的信息：</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scss">$ git remote -v<br>MyWebServer_origin      git<span class="hljs-keyword">@github</span>.<span class="hljs-attribute">com</span>:zy674517173/MyWebServer_origin.git (fetch)<br>MyWebServer_origin      git<span class="hljs-keyword">@github</span>.<span class="hljs-attribute">com</span>:zy674517173/MyWebServer_origin.git (push)<br></code></pre></td></tr></table></figure><p>然后根据名字删除，比如</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-variable">$</span> git remote <span class="hljs-built_in">rm</span> MyWebServer_origin<br></code></pre></td></tr></table></figure><h2 id="VsCode内使用Git版本控制"><a href="#VsCode内使用Git版本控制" class="headerlink" title="VsCode内使用Git版本控制"></a>VsCode内使用Git版本控制</h2><p>在VsCode中打开本地仓库，然后点击版本控制，如果提示 <strong>未找到Git。请安装Git，或在git.path设置中配置</strong></p><p>配置过程：设置 —&gt; 在搜索框输入 <code>git.path</code> —&gt; settings.json 中编辑</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-comment">// win系统</span><br><span class="hljs-string">&quot;git.path&quot;</span>: <span class="hljs-string">&quot;E:<span class="hljs-subst">\\</span>Program Files<span class="hljs-subst">\\</span>Git<span class="hljs-subst">\\</span>bin<span class="hljs-subst">\\</span>git.exe&quot;</span><br><br><span class="hljs-comment">// linux系统</span><br><span class="hljs-string">&quot;git.path&quot;</span>: <span class="hljs-string">&quot;/Program Files/Git/bin/git.exe&quot;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>General</title>
    <link href="/2024/05/31/General/"/>
    <url>/2024/05/31/General/</url>
    
    <content type="html"><![CDATA[<h1 id="总则"><a href="#总则" class="headerlink" title="总则"></a>总则</h1><p>hexo官方网站：[<a href="https://hexo.io/zh-cn/docs/">文档 | Hexo</a>]</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2024/05/31/hello-world/"/>
    <url>/2024/05/31/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="运行服务器"><a href="#运行服务器" class="headerlink" title="运行服务器"></a>运行服务器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="生成静态文件"><a href="#生成静态文件" class="headerlink" title="生成静态文件"></a>生成静态文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="部署到远端网址"><a href="#部署到远端网址" class="headerlink" title="部署到远端网址"></a>部署到远端网址</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><h2 id="Hexo遇到的问题"><a href="#Hexo遇到的问题" class="headerlink" title="Hexo遇到的问题"></a>Hexo遇到的问题</h2><h3 id="部署到GitHub后不能显示主题，只有文字"><a href="#部署到GitHub后不能显示主题，只有文字" class="headerlink" title="部署到GitHub后不能显示主题，只有文字"></a>部署到GitHub后不能显示主题，只有文字</h3><p><strong>原因：</strong> </p><p>1、GitHub 上的博客搭建到了仓库里，也就是博客跟地址是<a href="https://xxx.github.io/">https://XXX.github.io/</a><repository_name>上，而不是根目录<a href="https://xxx.github.io/%E4%B8%AD">https://XXX.github.io/中</a></p><p>2.由于主题中的各种图片、js脚本都是默认根路径的</p><p><strong>如何修改：</strong> 将Hexo的 <code>config.yml</code> 中的 <code>url</code> 改为根目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">// 原来是 url: https://zy674517173.github.io/archive<br>url: https://zy674517173.github.io<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
